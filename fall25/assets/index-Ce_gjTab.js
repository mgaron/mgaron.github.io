import{r as D,c as P,u as W,d as Y,w as X,o as ee,a as se,b as S,e as M,f,t as Se,n as z,F as Ce,g as Te,h as pe,i as $,j as R,k as ge,l as Pe,m as ne,p as _e,q as me,s as Re,v as De}from"./vendor-B-BnLpI9.js";import{S as We,O as $e,W as Ie,P as Le,a as Ee,C as ae,M as He,b as we,c as ye,d as be}from"./three-BjaYCcIN.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function o(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(r){if(r.ep)return;r.ep=!0;const i=o(r);fetch(r.href,i)}})();const le=D(null),he=D(!1),ve=D(null);function Ae(){const e=async(i="/fall25/data.json")=>{he.value=!0,ve.value=null;try{const s=await fetch(i);if(!s.ok)throw new Error(`Failed to load data: ${s.statusText}`);const l=await s.json(),g="/fall25/";l!=null&&l.photos&&(l.photos=l.photos.map(d=>({...d,url:d.url.startsWith("http")?d.url:`${g}${d.url}`,thumbnailUrl:d.thumbnailUrl?d.thumbnailUrl.startsWith("http")?d.thumbnailUrl:`${g}${d.thumbnailUrl}`:d.url.startsWith("http")?d.url:`${g}${d.url}`}))),le.value=l}catch(s){ve.value=s instanceof Error?s.message:"Unknown error occurred",console.error("Error loading data:",s)}finally{he.value=!1}},a=P(()=>{var i;return((i=le.value)==null?void 0:i.photos)||[]}),o=P(()=>{var i;return(i=le.value)==null?void 0:i.metadata}),n=P(()=>a.value.filter(i=>i.dateTaken!==null)),r=P(()=>{var i;return(i=o.value)!=null&&i.dateRange?{start:o.value.dateRange.start?new Date(o.value.dateRange.start):null,end:o.value.dateRange.end?new Date(o.value.dateRange.end):null}:null});return{data:le,loading:he,error:ve,photos:a,photosWithDates:n,metadata:o,dateRange:r,loadData:e}}function Fe(e){const a=D(0),o=D(.3),n=P(()=>[...W(e)].filter(p=>p.dateTaken!==null).sort((p,k)=>{const E=p.dateTaken?new Date(p.dateTaken).getTime():0,B=k.dateTaken?new Date(k.dateTaken).getTime():0;return E-B})),r=P(()=>n.value.length),i=P(()=>Math.floor(a.value*r.value)),s=P(()=>{const v=Math.ceil((a.value+o.value)*r.value);return Math.min(v,r.value)}),l=P(()=>n.value.slice(i.value,s.value)),g=P(()=>{if(l.value.length===0)return null;const v=l.value[0],p=l.value[l.value.length-1];return{start:v.dateTaken?new Date(v.dateTaken):null,end:p.dateTaken?new Date(p.dateTaken):null}}),d=v=>{a.value=Math.max(0,Math.min(1-o.value,v))};return{scrollPosition:a,visibleRangeSize:o,sortedPhotos:n,visiblePhotos:l,visibleDateRange:g,startIndex:i,endIndex:s,setScrollPosition:d,handleScroll:v=>{const k=a.value+v*5e-4;d(k)},jumpToDate:v=>{if(n.value.length===0)return;const p=v.getTime(),k=n.value[0].dateTaken?new Date(n.value[0].dateTaken).getTime():0,E=n.value[n.value.length-1].dateTaken?new Date(n.value[n.value.length-1].dateTaken).getTime():0;if(E===k){d(0);return}const B=(p-k)/(E-k);d(B)}}}const Be=Y({__name:"GlassCanvas",props:{width:{},height:{},parallaxOffset:{default:0}},setup(e,{expose:a}){const o=e,n=D(null),r=D(null);let i=null,s=null,l=null,g=null;a({getScene:()=>i,getCamera:()=>s,getRenderer:()=>l});const d=()=>{if(!r.value)return;i=new We,i.background=null;const v=o.width/o.height,p=o.height;s=new $e(-p*v/2,p*v/2,p/2,-p/2,.1,1e3),s.position.z=10,l=new Ie({canvas:r.value,alpha:!0,antialias:!0}),l.setSize(o.width,o.height),l.setPixelRatio(window.devicePixelRatio),h()},h=()=>{!i||!s||!l||(g=requestAnimationFrame(h),l.render(i,s))},u=()=>{if(!s||!l)return;const v=o.width/o.height,p=o.height;s.left=-p*v/2,s.right=p*v/2,s.top=p/2,s.bottom=-p/2,s.updateProjectionMatrix(),l.setSize(o.width,o.height)};return X(()=>o.parallaxOffset,v=>{s&&(s.position.y=v)}),X([()=>o.width,()=>o.height],()=>{u()}),ee(()=>{d()}),se(()=>{g!==null&&cancelAnimationFrame(g),l&&l.dispose()}),(v,p)=>(M(),S("div",{ref_key:"containerRef",ref:n,class:"glass-canvas-container"},[f("canvas",{ref_key:"canvasRef",ref:r,class:"glass-canvas"},null,512)],512))}}),j=(e,a)=>{const o=e.__vccOpts||e;for(const[n,r]of a)o[n]=r;return o},xe=j(Be,[["__scopeId","data-v-31883d9c"]]);function J(e){const a=e.r/255,o=e.g/255,n=e.b/255,r=Math.max(a,o,n),i=Math.min(a,o,n),s=r-i;let l=0,g=0;const d=(r+i)/2;if(s!==0)switch(g=d>.5?s/(2-r-i):s/(r+i),r){case a:l=((o-n)/s+(o<n?6:0))/6;break;case o:l=((n-a)/s+2)/6;break;case n:l=((a-o)/s+4)/6;break}return{h:l*360,s:g*100,l:d*100}}function Oe(e){const a=e.reduce((l,g)=>l+g.weight,0);if(a===0)return{h:0,s:0,l:50};let o=0,n=0,r=0,i=0;e.forEach(({color:l,weight:g})=>{const d=g/a,h=l.h*Math.PI/180;o+=Math.sin(h)*d,n+=Math.cos(h)*d,r+=l.s*d,i+=l.l*d});const s=Math.atan2(o,n)*180/Math.PI;return{h:s<0?s+360:s,s:r,l:i}}function K(e){return{green:{r:50,g:150,b:50},red:{r:200,g:30,b:30},orange:{r:255,g:140,b:0},yellow:{r:255,g:220,b:50},white:{r:240,g:240,b:240},brown:{r:139,g:90,b:43}}[e]||{r:128,g:128,b:128}}function Ne(e){return`hsl(${Math.round(e.h)}, ${Math.round(e.s)}%, ${Math.round(e.l)}%)`}function Ue(e,a=20){const o=i=>{const s=W(e),l=Math.floor(a/2),g=Math.max(0,i-l),d=Math.min(s.length,i+l+1),h=s.slice(g,d),u=h.length;if(u===0)return{green:0,red:0,orange:0,yellow:0,white:0,brown:0};const v=h.reduce((p,k)=>({green:p.green+k.colors.green,red:p.red+k.colors.red,orange:p.orange+k.colors.orange,yellow:p.yellow+k.colors.yellow,white:p.white+k.colors.white,brown:p.brown+k.colors.brown}),{green:0,red:0,orange:0,yellow:0,white:0,brown:0});return{green:v.green/u,red:v.red/u,orange:v.orange/u,yellow:v.yellow/u,white:v.white/u,brown:v.brown/u}},n=(i,s)=>{if(W(e).length===0)return"hsl(0, 0%, 95%)";const g=Math.floor((i+s)/2),d=o(g),h=[{color:J(K("green")),weight:d.green},{color:J(K("red")),weight:d.red},{color:J(K("orange")),weight:d.orange},{color:J(K("yellow")),weight:d.yellow},{color:J(K("white")),weight:d.white},{color:J(K("brown")),weight:d.brown}],u=Oe(h);return u.s=Math.min(u.s*.4,40),u.l=Math.max(u.l*1.2,85),Ne(u)},r=P(()=>W(e).map((s,l)=>o(l)));return{calculateRollingAverage:o,getColorWashForRange:n,getRollingAverages:r}}const Ge=Y({__name:"ColorLayer",props:{photos:{},visibleStartIndex:{},visibleEndIndex:{},glassCanvas:{},opacity:{default:.3}},setup(e){const a=e,o=D(null);let n=null,r=null;const{getColorWashForRange:i}=Ue(Se(a,"photos")),s=P(()=>i(a.visibleStartIndex,a.visibleEndIndex)),l=()=>{const d=a.glassCanvas.getScene(),h=a.glassCanvas.getCamera();if(!d||!h)return;const u=new Le(2e3,2e3);r=new Ee({uniforms:{color1:{value:new ae(16777215)},color2:{value:new ae(16777215)},opacity:{value:a.opacity}},vertexShader:`
      varying vec2 vUv;
      void main() {
        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
      }
    `,fragmentShader:`
      uniform vec3 color1;
      uniform vec3 color2;
      uniform float opacity;
      varying vec2 vUv;
      
      void main() {
        vec3 color = mix(color1, color2, vUv.y);
        gl_FragColor = vec4(color, opacity);
      }
    `,transparent:!0,depthWrite:!1}),n=new He(u,r),n.position.z=-5,d.add(n),g()},g=()=>{if(!r)return;const d=s.value.match(/hsl\((\d+),\s*(\d+)%,\s*(\d+)%\)/);if(d){const h=parseInt(d[1])/360,u=parseInt(d[2])/100,v=parseInt(d[3])/100,p=new ae().setHSL(h,u,v);r.uniforms.color1.value=p;const k=new ae().setHSL((h+.05)%1,u*.8,Math.min(v*1.1,1));r.uniforms.color2.value=k}};return X(s,()=>{g()}),X(()=>a.opacity,d=>{r&&(r.uniforms.opacity.value=d)}),ee(()=>{l()}),(d,h)=>(M(),S("div",{ref_key:"layerRef",ref:o,class:"color-layer"},null,512))}}),Xe=j(Ge,[["__scopeId","data-v-4f46c7cc"]]);function Ye(e,a,o,n,r=1){e.save(),e.globalAlpha=r,e.fillStyle="#FFD700",e.strokeStyle="#FFD700",e.lineWidth=n*.1,e.beginPath(),e.arc(a,o,n*.3,0,Math.PI*2),e.fill();for(let i=0;i<8;i++){const s=i*Math.PI/4,l=a+Math.cos(s)*n*.4,g=o+Math.sin(s)*n*.4,d=a+Math.cos(s)*n*.6,h=o+Math.sin(s)*n*.6;e.beginPath(),e.moveTo(l,g),e.lineTo(d,h),e.stroke()}e.restore()}function Me(e,a,o,n,r=1){e.save(),e.globalAlpha=r,e.fillStyle="#B0C4DE",e.strokeStyle="#708090",e.lineWidth=n*.05,e.beginPath(),e.arc(a-n*.2,o,n*.25,0,Math.PI*2),e.arc(a,o-n*.1,n*.3,0,Math.PI*2),e.arc(a+n*.2,o,n*.25,0,Math.PI*2),e.rect(a-n*.35,o,n*.7,n*.2),e.fill(),e.stroke(),e.restore()}function je(e,a,o,n,r=1){e.save(),e.globalAlpha=r,e.fillStyle="#778899",e.strokeStyle="#696969",e.lineWidth=n*.05,e.beginPath(),e.arc(a-n*.15,o-n*.1,n*.2,0,Math.PI*2),e.arc(a,o-n*.15,n*.25,0,Math.PI*2),e.arc(a+n*.15,o-n*.1,n*.2,0,Math.PI*2),e.rect(a-n*.3,o-n*.1,n*.6,n*.15),e.fill(),e.stroke(),e.strokeStyle="#4682B4",e.lineWidth=n*.08,e.lineCap="round";for(let i=0;i<3;i++){const s=a-n*.2+i*n*.2,l=o+n*.1;e.beginPath(),e.moveTo(s,l),e.lineTo(s,l+n*.25),e.stroke()}e.restore()}function Ve(e,a,o,n,r,i,s=1){e.save(),e.globalAlpha=s,e.translate(a,o),e.rotate(r*Math.PI/180);const l=n*.4*Math.min(i/30,1),g=n*.15;e.strokeStyle="#4A5568",e.fillStyle="#4A5568",e.lineWidth=n*.06,e.lineCap="round",e.lineJoin="round",e.beginPath(),e.moveTo(0,-l),e.lineTo(0,l*.2),e.stroke(),e.beginPath(),e.moveTo(0,-l),e.lineTo(-g,-l+g),e.lineTo(0,-l+g*.5),e.lineTo(g,-l+g),e.closePath(),e.fill(),e.restore()}function qe(e){if(!e)return Me;const a=e.toLowerCase();return a.includes("sun")||a.includes("clear")||a.includes("fair")?Ye:a.includes("rain")||a.includes("shower")||a.includes("drizzle")?je:Me}const Je=Y({__name:"WeatherLayer",props:{photos:{},gridCols:{},cellWidth:{},cellHeight:{},glassCanvas:{},opacity:{default:.6},sparsity:{default:10}},setup(e){const a=e,o=D(null),n=[],r=[],i=(h,u=128)=>{var k;const v=document.createElement("canvas");v.width=u,v.height=u;const p=v.getContext("2d");if(p.clearRect(0,0,u,u),(k=h.weather)!=null&&k.conditions){const E=qe(h.weather.conditions),B=h.weather.precipitation?Math.min(.5+h.weather.precipitation/10,1):.7;E(p,u/2,u/2,u*.4,B)}return new be(v)},s=(h,u=64)=>{var k,E;if(!((k=h.weather)!=null&&k.windDirection)||!((E=h.weather)!=null&&E.windSpeed))return null;const v=document.createElement("canvas");v.width=u,v.height=u;const p=v.getContext("2d");return p.clearRect(0,0,u,u),Ve(p,u/2,u/2,u*.4,h.weather.windDirection,h.weather.windSpeed,.8),new be(v)},l=()=>{const h=a.glassCanvas.getScene(),u=a.glassCanvas.getCamera();!h||!u||(n.forEach(v=>h.remove(v)),r.forEach(v=>h.remove(v)),n.length=0,r.length=0,a.photos.forEach((v,p)=>{if(p%a.sparsity!==0||!v.weather)return;const k=Math.floor(p/a.gridCols),B=p%a.gridCols*a.cellWidth+a.cellWidth/2-a.gridCols*a.cellWidth/2,V=-(k*a.cellHeight+a.cellHeight/2)+100,Q=i(v),H=new we({map:Q,transparent:!0,opacity:a.opacity}),x=new ye(H);x.position.set(B,V,0),x.scale.set(a.cellWidth*.6,a.cellWidth*.6,1),x.floatOffset=Math.random()*Math.PI*2,x.floatSpeed=.001+Math.random()*.001,h.add(x),n.push(x);const U=s(v);if(U){const q=new we({map:U,transparent:!0,opacity:a.opacity*.8}),N=new ye(q);N.position.set(B,V-a.cellHeight*.35,.1),N.scale.set(a.cellWidth*.4,a.cellWidth*.4,1),h.add(N),r.push(N)}}),d())};let g=null;const d=()=>{n.forEach(h=>{const u=h.floatOffset||0,v=h.floatSpeed||.001,p=Date.now()*v;h.position.y+=Math.sin(p+u)*.05}),g=requestAnimationFrame(d)};return X(()=>a.opacity,h=>{n.forEach(u=>{u.material&&(u.material.opacity=h)}),r.forEach(u=>{u.material&&(u.material.opacity=h*.8)})}),X(()=>a.photos.length,()=>{l()}),ee(()=>{l()}),se(()=>{g!==null&&cancelAnimationFrame(g)}),(h,u)=>(M(),S("div",{ref_key:"layerRef",ref:o,class:"weather-layer"},null,512))}}),Ke=j(Je,[["__scopeId","data-v-4c77edce"]]),Qe=["onMouseenter"],Ze=["src","alt"],ze=Y({__name:"PhotoGrid",props:{photos:{},columns:{default:8},gap:{default:8},focusMode:{type:Boolean,default:!1}},emits:["hover","leave"],setup(e,{emit:a}){const o=e,n=a,r=P(()=>({gridTemplateColumns:`repeat(${o.columns}, 1fr)`,gap:`${o.gap}px`})),i=l=>{n("hover",l)},s=()=>{n("leave")};return(l,g)=>(M(),S("div",{class:"photo-grid",style:z(r.value)},[(M(!0),S(Ce,null,Te(e.photos,d=>(M(),S("div",{key:d.id,class:pe(["photo-item",{grayscale:e.focusMode}]),onMouseenter:h=>i(d),onMouseleave:s},[f("img",{src:d.thumbnailUrl,alt:`Leaf photo ${d.id}`,loading:"lazy",class:"photo-thumbnail"},null,8,Ze)],42,Qe))),128))],4))}}),et=j(ze,[["__scopeId","data-v-df4f48d7"]]),tt={class:"photo-preview"},ot=["src","alt"],nt={class:"detail-content glass-panel"},at={class:"photo-title"},lt={key:0,class:"detail-section"},st={class:"detail-value"},it={key:1,class:"detail-section"},rt={class:"detail-value"},ct={class:"detail-section"},dt={class:"color-bars"},ut={class:"color-label"},ht={class:"color-value"},vt={key:2,class:"detail-section"},gt={class:"weather-info"},pt={key:0,class:"weather-item"},ft={key:1,class:"weather-item"},mt={key:2,class:"weather-item"},wt={key:3,class:"weather-item"},yt={key:4,class:"weather-item"},bt=Y({__name:"PhotoDetail",props:{photo:{},x:{default:0},y:{default:0}},setup(e){const a=e,o=P(()=>{if(!a.photo)return{display:"none"};const i=680,s=600,l=20,g=window.innerWidth,d=window.innerHeight;let h=a.x+l,u=a.y+l;return h+i>g&&(h=a.x-i-l,h<0&&(h=g-i-l,h<0&&(h=l))),u+s>d&&(u=a.y-s-l,u<0&&(u=d-s-l,u<0&&(u=l))),{left:`${h}px`,top:`${u}px`,display:"flex"}}),n=i=>ge(new Date(i),"MMM d, yyyy h:mm a"),r=(i,s)=>({background:`linear-gradient(to right, ${{green:"#32965d",red:"#c81e1e",orange:"#ff8c00",yellow:"#ffd700",white:"#e8e8e8",brown:"#8b5a2b"}[i]||"#888"} ${s}%, transparent ${s}%)`});return(i,s)=>e.photo?(M(),S("div",{key:0,class:"photo-detail",style:z(o.value)},[f("div",tt,[f("img",{src:e.photo.url,alt:`Leaf photo ${e.photo.id}`,class:"full-resolution-image"},null,8,ot)]),f("div",nt,[f("h3",at,"Photo #"+R(e.photo.id),1),e.photo.dateTaken?(M(),S("div",lt,[s[0]||(s[0]=f("span",{class:"detail-label"},"Date:",-1)),f("span",st,R(n(e.photo.dateTaken)),1)])):$("",!0),e.photo.latitude&&e.photo.longitude?(M(),S("div",it,[s[1]||(s[1]=f("span",{class:"detail-label"},"Location:",-1)),f("span",rt,R(e.photo.latitude.toFixed(4))+", "+R(e.photo.longitude.toFixed(4)),1)])):$("",!0),f("div",ct,[s[2]||(s[2]=f("span",{class:"detail-label"},"Colors:",-1)),f("div",dt,[(M(!0),S(Ce,null,Te(e.photo.colors,(l,g)=>(M(),S("div",{key:g,class:"color-bar",style:z(r(g,l))},[f("span",ut,R(g),1),f("span",ht,R(l.toFixed(1))+"%",1)],4))),128))])]),e.photo.weather?(M(),S("div",vt,[s[3]||(s[3]=f("span",{class:"detail-label"},"Weather:",-1)),f("div",gt,[e.photo.weather.temperature!==null?(M(),S("div",pt,[f("span",null,"üå°Ô∏è "+R(e.photo.weather.temperature.toFixed(1))+"¬∞C",1)])):$("",!0),e.photo.weather.humidity!==null?(M(),S("div",ft,[f("span",null,"üíß "+R(e.photo.weather.humidity.toFixed(0))+"%",1)])):$("",!0),e.photo.weather.precipitation!==null?(M(),S("div",mt,[f("span",null,"üåßÔ∏è "+R(e.photo.weather.precipitation.toFixed(1))+"mm",1)])):$("",!0),e.photo.weather.windSpeed!==null?(M(),S("div",wt,[f("span",null,"üí® "+R(e.photo.weather.windSpeed.toFixed(1))+"km/h",1)])):$("",!0),e.photo.weather.conditions?(M(),S("div",yt,[f("span",null,R(e.photo.weather.conditions),1)])):$("",!0)])])):$("",!0)])],4)):$("",!0)}}),Mt=j(bt,[["__scopeId","data-v-c63e5786"]]);function ke(e,a=10){if(e.length<2)return e;const o=[];for(let n=0;n<e.length-1;n++){const r=e[Math.max(0,n-1)],i=e[n],s=e[n+1],l=e[Math.min(e.length-1,n+2)];for(let g=0;g<=a;g++){const d=g/a,h=d*d,u=h*d,v=.5*(2*i.x+(-r.x+s.x)*d+(2*r.x-5*i.x+4*s.x-l.x)*h+(-r.x+3*i.x-3*s.x+l.x)*u),p=.5*(2*i.y+(-r.y+s.y)*d+(2*r.y-5*i.y+4*s.y-l.y)*h+(-r.y+3*i.y-3*s.y+l.y)*u);(g<a||n===e.length-2)&&o.push({x:v,y:p})}}return o}const kt={class:"panel-header"},Ct={class:"date-display"},Tt={key:0,class:"current-range"},St={key:1,class:"full-range"},Pt=["width","height"],_t={class:"tooltip-date"},Rt={key:0,class:"tooltip-row"},Dt={class:"tooltip-value"},Wt={key:1,class:"tooltip-row"},$t={class:"tooltip-value"},It={key:2,class:"tooltip-row"},Lt={class:"tooltip-value"},Et={key:3,class:"tooltip-row color-breakdown"},Ht={class:"tooltip-value"},At=200,Ft=10,Bt=50,A=20,xt=Y({__name:"DataTimelinePanel",props:{photos:{},visibleStartIndex:{},visibleEndIndex:{},scrollPosition:{},visibleRangeSize:{},visibleDateRange:{},fullDateRange:{},isAtBottom:{type:Boolean}},emits:["update:scrollPosition"],setup(e,{emit:a}){const o=e,n=a,r=D(null),i=D(null),s=D(!1),l=D(null),g=P(()=>{var t;return((t=r.value)==null?void 0:t.clientWidth)||800}),d=P(()=>At),h=P(()=>o.photos.map(t=>{var c;return(c=t.weather)==null?void 0:c.temperature}).filter(t=>t!=null)),u=P(()=>o.photos.map(t=>{var c;return(c=t.weather)==null?void 0:c.precipitation}).filter(t=>t!=null)),v=P(()=>o.photos.map(t=>{var c;return(c=t.weather)==null?void 0:c.humidity}).filter(t=>t!=null)),p=t=>{const c=t.colors,w=[{name:"Green",value:c.green},{name:"Red",value:c.red},{name:"Orange",value:c.orange},{name:"Yellow",value:c.yellow},{name:"White",value:c.white},{name:"Brown",value:c.brown}].filter(m=>m.value>5).sort((m,C)=>C.value-m.value);return w.length===0?"Mixed":w.map(m=>`${m.name} ${m.value.toFixed(1)}%`).join(", ")},k=P(()=>Math.floor(Math.min(...h.value,0))),E=P(()=>Math.ceil(Math.max(...h.value,30))),B=P(()=>Math.ceil(Math.max(...u.value,10))),V=P(()=>({left:`${o.scrollPosition*100}%`,width:`${o.visibleRangeSize*100}%`})),Q=P(()=>l.value?{left:`${l.value.x}px`,transform:l.value.x>g.value/2?"translate(-100%, -10px)":"translate(0, -10px)"}:{}),H=t=>t?ge(t,"MMM d, yyyy"):"",x=()=>{const t=i.value;if(!t){console.log("Canvas not found");return}const c=t.getContext("2d");if(!c){console.log("Could not get canvas context");return}if(console.log("Drawing chart, canvas size:",t.width,"x",t.height),c.clearRect(0,0,t.width,t.height),o.photos.length===0){console.log("No photos to display"),c.fillStyle="#666",c.font="14px sans-serif",c.textAlign="center",c.fillText("No data available",t.width/2,t.height/2);return}const b=t.width-A*2,w=Ft,m=t.height-Bt,C=m-w;console.log("Chart dimensions:",b,"x",C),te(c,b,w,m),U(c,b,w,m),q(c,b,w,m),ie(c,b,w,m),N(c,b,w,m),re(c,b,m),console.log("Chart drawing complete")},U=(t,c,b,w)=>{t.save(),t.strokeStyle="rgba(200, 200, 200, 0.3)",t.lineWidth=1,t.setLineDash([5,5]);const m=4;for(let C=0;C<=m;C++){const y=b+(w-b)*(C/m);t.beginPath(),t.moveTo(A,y),t.lineTo(A+c,y),t.stroke()}t.restore()},q=(t,c,b,w)=>{u.value.length!==0&&(t.save(),t.fillStyle="rgba(70, 130, 180, 0.4)",o.photos.forEach((m,C)=>{var L;const y=(L=m.weather)==null?void 0:L.precipitation;if(!y||y===0)return;const _=A+C/(o.photos.length-1)*c,T=y/B.value*(w-b)*.3,F=w-T,I=Math.max(2,c/o.photos.length);t.fillRect(_-I/2,F,I,T)}),t.restore())},N=(t,c,b,w)=>{if(h.value.length===0){console.log("No temperature data available");return}const m=o.photos.map((_,T)=>{var fe;const F=(fe=_.weather)==null?void 0:fe.temperature;if(F==null)return null;const I=A+T/Math.max(1,o.photos.length-1)*c,L=(F-k.value)/(E.value-k.value),O=w-L*(w-b);return{x:I,y:O}}).filter(_=>_!==null);if(console.log("Temperature points:",m.length,"First point:",m[0]),m.length<2){console.log("Not enough temperature points to draw line");return}const C=ke(m,8);console.log("Smooth points:",C.length),t.save(),t.strokeStyle="rgba(255, 100, 50, 0.8)",t.lineWidth=3,t.lineCap="round",t.lineJoin="round",t.shadowColor="rgba(255, 100, 50, 0.5)",t.shadowBlur=10,t.beginPath(),C.forEach((_,T)=>{T===0?t.moveTo(_.x,_.y):t.lineTo(_.x,_.y)}),t.stroke(),t.shadowBlur=0;const y=t.createLinearGradient(0,b,0,w);if(y.addColorStop(0,"rgba(255, 100, 50, 0.2)"),y.addColorStop(1,"rgba(255, 100, 50, 0.05)"),t.fillStyle=y,C.length>0){const _=C[C.length-1],T=C[0];_&&T&&(t.lineTo(_.x,w),t.lineTo(T.x,w),t.closePath(),t.fill())}t.restore(),console.log("Temperature line drawn")},te=(t,c,b,w)=>{t.save();const m=4,C=w+2;o.photos.forEach((y,_)=>{const T=y.colors,F=A+_/Math.max(1,o.photos.length-1)*c,I=Math.max(2,c/o.photos.length);let L="rgba(100, 100, 100, 0.3)";const O=Math.max(T.red||0,T.orange||0,T.yellow||0,T.green||0,T.brown||0,T.white||0);O===T.green?L="rgba(50, 150, 50, 0.8)":O===T.red?L="rgba(200, 50, 50, 0.8)":O===T.orange?L="rgba(255, 140, 50, 0.8)":O===T.yellow?L="rgba(220, 200, 50, 0.8)":O===T.brown?L="rgba(130, 80, 40, 0.8)":O===T.white&&(L="rgba(230, 230, 230, 0.8)"),t.fillStyle=L,t.fillRect(F-I/2,C,I,m)}),t.restore()},ie=(t,c,b,w)=>{if(v.value.length===0)return;const m=o.photos.map((y,_)=>{var O;const T=(O=y.weather)==null?void 0:O.humidity;if(T==null)return null;const F=A+_/Math.max(1,o.photos.length-1)*c,I=T/100,L=w-I*(w-b)*.7;return{x:F,y:L}}).filter(y=>y!==null);if(m.length<2)return;const C=ke(m,8);t.save(),t.strokeStyle="rgba(100, 180, 255, 0.5)",t.lineWidth=2,t.lineCap="round",t.lineJoin="round",t.setLineDash([5,3]),t.beginPath(),C.forEach((y,_)=>{_===0?t.moveTo(y.x,y.y):t.lineTo(y.x,y.y)}),t.stroke(),t.restore()},re=(t,c,b)=>{var m,C;if(!((m=o.fullDateRange)!=null&&m.start)||!((C=o.fullDateRange)!=null&&C.end))return;t.save(),t.fillStyle="#4a5568",t.font="11px sans-serif",t.textAlign="center";const w=5;for(let y=0;y<w;y++){const _=y/(w-1),T=A+_*c,F=Math.round(_*(o.photos.length-1)),I=o.photos[F];if(I!=null&&I.dateTaken){const L=new Date(I.dateTaken),O=ge(L,"MMM d");t.fillText(O,T,b+20)}}t.restore()},oe=t=>{var y;const c=(y=r.value)==null?void 0:y.getBoundingClientRect();if(!c)return;const b=t.clientX-c.left,w=c.width-A*2,m=(b-A)/w,C=Math.max(0,Math.min(1-o.visibleRangeSize,m-o.visibleRangeSize/2));n("update:scrollPosition",C)},ce=t=>{var _,T,F,I;const c=(_=r.value)==null?void 0:_.getBoundingClientRect();if(!c)return;const b=t.clientX-c.left-A,w=c.width-A*2;if(b<0||b>w){l.value=null;return}const m=b/w,C=Math.round(m*(o.photos.length-1)),y=o.photos[C];y&&(l.value={date:y.dateTaken?new Date(y.dateTaken):new Date,temp:((T=y.weather)==null?void 0:T.temperature)??null,humidity:((F=y.weather)==null?void 0:F.humidity)??null,precip:((I=y.weather)==null?void 0:I.precipitation)??null,colorBreakdown:p(y),x:b+A})},de=()=>{l.value=null},ue=t=>{s.value=!0,t.preventDefault(),t.stopPropagation()},G=t=>{var C;if(!s.value)return;const c=(C=r.value)==null?void 0:C.getBoundingClientRect();if(!c)return;const b=t.clientX-c.left,w=c.width-A*2,m=(b-A)/w;n("update:scrollPosition",Math.max(0,Math.min(1-o.visibleRangeSize,m)))},Z=()=>{s.value=!1};return X(()=>[o.photos,g.value,d.value],()=>{x()},{deep:!0}),ee(()=>{setTimeout(()=>{console.log("DataTimelinePanel mounted, photos:",o.photos.length),console.log("Canvas size:",g.value,"x",d.value),console.log("Temp data points:",h.value.length),console.log("Humidity data points:",v.value.length),x()},100),window.addEventListener("mousemove",G),window.addEventListener("mouseup",Z),window.addEventListener("resize",x)}),se(()=>{window.removeEventListener("mousemove",G),window.removeEventListener("mouseup",Z),window.removeEventListener("resize",x)}),(t,c)=>{var b,w,m;return M(),S("div",{class:pe(["data-timeline-panel glass-panel",{"align-top":o.isAtBottom}])},[f("div",kt,[f("div",Ct,[e.visibleDateRange?(M(),S("span",Tt,R(H(e.visibleDateRange.start))+" - "+R(H(e.visibleDateRange.end)),1)):$("",!0),e.fullDateRange?(M(),S("span",St," of "+R(H(e.fullDateRange.start))+" - "+R(H(e.fullDateRange.end)),1)):$("",!0)]),c[0]||(c[0]=Pe('<div class="legend" data-v-d93cb81a><div class="legend-item" data-v-d93cb81a><div class="legend-color temp" data-v-d93cb81a></div><span data-v-d93cb81a>Temperature</span></div><div class="legend-item" data-v-d93cb81a><div class="legend-color humidity" data-v-d93cb81a></div><span data-v-d93cb81a>Humidity</span></div><div class="legend-item" data-v-d93cb81a><div class="legend-color precip" data-v-d93cb81a></div><span data-v-d93cb81a>Precipitation</span></div><div class="legend-item" data-v-d93cb81a><div class="legend-color leaf-color" data-v-d93cb81a></div><span data-v-d93cb81a>Leaf Color</span></div></div>',1))]),f("div",{ref_key:"containerRef",ref:r,class:"chart-container",onClick:oe,onMousemove:ce,onMouseleave:de},[f("canvas",{ref_key:"canvasRef",ref:i,class:"timeline-canvas",width:g.value,height:d.value},null,8,Pt),f("div",{class:"viewport-indicator",style:z(V.value),onMousedown:ue},[...c[1]||(c[1]=[f("div",{class:"viewport-handle left"},null,-1),f("div",{class:"viewport-handle right"},null,-1)])],36),l.value?(M(),S("div",{key:0,class:"hover-tooltip",style:z(Q.value)},[f("div",_t,R(H(l.value.date)),1),l.value.temp!==null?(M(),S("div",Rt,[c[2]||(c[2]=f("span",{class:"tooltip-label"},"Temperature:",-1)),f("span",Dt,R((b=l.value.temp)==null?void 0:b.toFixed(1))+"¬∞C",1)])):$("",!0),l.value.humidity!==null?(M(),S("div",Wt,[c[3]||(c[3]=f("span",{class:"tooltip-label"},"Humidity:",-1)),f("span",$t,R((w=l.value.humidity)==null?void 0:w.toFixed(0))+"%",1)])):$("",!0),l.value.precip!==null&&l.value.precip>0?(M(),S("div",It,[c[4]||(c[4]=f("span",{class:"tooltip-label"},"Precipitation:",-1)),f("span",Lt,R((m=l.value.precip)==null?void 0:m.toFixed(1))+"mm",1)])):$("",!0),l.value.colorBreakdown?(M(),S("div",Et,[c[5]||(c[5]=f("span",{class:"tooltip-label"},"Leaf Colors:",-1)),f("span",Ht,R(l.value.colorBreakdown),1)])):$("",!0)],4)):$("",!0)],544)],2)}}}),Ot=j(xt,[["__scopeId","data-v-d93cb81a"]]),Nt={key:0,class:"loading-screen glass-panel"},Ut={key:1,class:"error-screen glass-panel"},Gt={key:2,class:"main-content"},Xt={key:0},Yt={key:1},jt=Y({__name:"App",setup(e){const a=D(window.innerWidth),o=D(window.innerHeight),n=P(()=>a.value<768?4:a.value<1200?6:8),r=P(()=>a.value/n.value),i=P(()=>r.value),{photos:s,dateRange:l,loading:g,error:d,loadData:h}=Ae();X(s,t=>{t.length>0&&(document.title=`${t.length} times i thought about you this fall`)},{immediate:!0});const{visiblePhotos:u,visibleDateRange:v,scrollPosition:p,visibleRangeSize:k,startIndex:E,endIndex:B,handleScroll:V,setScrollPosition:Q}=Fe(s),H=D(!1),x=()=>{H.value=!H.value},U=D(null),q=D(null),N=D(0),te=D(0),ie=t=>{U.value=t,q.value=t.id},re=()=>{U.value=null,q.value=null},oe=t=>{N.value=t.clientX,te.value=t.clientY},ce=t=>{V(t.deltaY)},de=P(()=>p.value*100),ue=P(()=>{if(s.value.length===0)return!1;const c=u.value.length,b=Math.ceil(c/n.value);return b*i.value+(b-1)*16+32<o.value?!1:p.value+k.value>.85}),G=D(null),Z=()=>{a.value=window.innerWidth,o.value=window.innerHeight};return ee(async()=>{await h(),window.addEventListener("resize",Z),window.addEventListener("mousemove",oe)}),se(()=>{window.removeEventListener("resize",Z),window.removeEventListener("mousemove",oe)}),(t,c)=>(M(),S("div",{class:"app",onWheel:Re(ce,["prevent"])},[W(g)?(M(),S("div",Nt,[...c[0]||(c[0]=[f("div",{class:"loading-content"},[f("div",{class:"spinner"}),f("p",null,"Loading leaf data...")],-1)])])):W(d)?(M(),S("div",Ut,[c[1]||(c[1]=f("h2",null,"Error Loading Data",-1)),f("p",null,R(W(d)),1)])):(M(),S("div",Gt,[f("button",{class:pe(["focus-toggle glass-panel",{active:H.value}]),onClick:x},[H.value?(M(),S("span",Xt,"üìä Data Focus")):(M(),S("span",Yt,"üñºÔ∏è Photos"))],2),ne(xe,{ref_key:"glassCanvasRef",ref:G,width:a.value,height:o.value,"parallax-offset":de.value},{default:_e(()=>[G.value?(M(),me(Xe,{key:0,photos:W(u),"visible-start-index":W(E),"visible-end-index":W(B),"glass-canvas":G.value,opacity:H.value?.8:.3},null,8,["photos","visible-start-index","visible-end-index","glass-canvas","opacity"])):$("",!0),G.value?(M(),me(Ke,{key:1,photos:W(u),"grid-cols":n.value,"cell-width":r.value,"cell-height":i.value,"glass-canvas":G.value,opacity:H.value?.9:.6},null,8,["photos","grid-cols","cell-width","cell-height","glass-canvas","opacity"])):$("",!0)]),_:1},8,["width","height","parallax-offset"]),ne(et,{photos:W(u),columns:n.value,gap:16,"focus-mode":H.value,onHover:ie,onLeave:re},null,8,["photos","columns","focus-mode"]),ne(Mt,{photo:U.value,x:N.value,y:te.value},null,8,["photo","x","y"]),ne(Ot,{photos:W(s),"visible-start-index":W(E),"visible-end-index":W(B),"scroll-position":W(p),"visible-range-size":W(k),"visible-date-range":W(v),"full-date-range":W(l),"is-at-bottom":ue.value,"onUpdate:scrollPosition":W(Q)},null,8,["photos","visible-start-index","visible-end-index","scroll-position","visible-range-size","visible-date-range","full-date-range","is-at-bottom","onUpdate:scrollPosition"])]))],32))}}),Vt=j(jt,[["__scopeId","data-v-fe422b2b"]]);De(Vt).mount("#app");
